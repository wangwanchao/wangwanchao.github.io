---
title: 原子变量与非阻塞同步机制
date: 2018-07-31 17:54:45
tags: java, 多线程
categories: 多线程
---

非阻塞算法：用底层的原子机器指令(比较交换指令)代替锁来确保数据并发访问的一致性。

优点：

> 在粒度更细的层次上进行协调，极大地减少调度开销。
>
> 不存在死锁和其它活跃性问题。

## 硬件对并发的支持 ##

处理器实现原子指令：

CAS: 比较并交换(Compare-and-Swap)

LL/SC: 关联加载/条件存储(Load-Linked/Store-Conditional)

### 1、比较并交换 ###

CAS包括3个操作数：

> 需要读写的内存位置V
> 
> 进行比较的值A
> 
> 拟写入的新值B

当且仅当V=A时，CAS才会通过原子方式用新值B来更新V的值。

优点：

> 在竞争程度不高时，性能远远超过基于锁

缺点：

> 它使调用者处理竞争问题(通过重试、回退、放弃)，而在锁中能自动处理竞争问题(线程在获得锁之前将一直阻塞)


2、